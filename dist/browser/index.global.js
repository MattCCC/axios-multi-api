(()=>{var S=Object.create;var m=Object.defineProperty;var q=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var M=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var j=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of x(e))!k.call(n,r)&&r!==t&&m(n,r,{get:()=>e[r],enumerable:!(s=q(e,r))||s.enumerable});return n};var E=(n,e,t)=>(t=n!=null?S(P(n)):{},j(e||!n||!n.__esModule?m(t,"default",{value:n,enumerable:!0}):t,n));var y=(n,e,t,s)=>{for(var r=s>1?void 0:s?q(e,t):e,o=n.length-1,i;o>=0;o--)(i=n[o])&&(r=(s?i(e,t,r):i(r))||r);return s&&r&&m(e,t,r),r};var R=M(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.applyMagic=l.__invoke=l.__delete=l.__has=l.__set=l.__get=void 0;l.__get=Symbol("__get");l.__set=Symbol("__set");l.__has=Symbol("__has");l.__delete=Symbol("__delete");l.__invoke=Symbol("__invoke");var C=!1;function A(n,e=!1){if(typeof n=="function"){if(e)return g(n);let t=function(...r){if(typeof this>"u"){let o=n[l.__invoke]||n.__invoke;if(o)return d(n,o,"__invoke"),o?o.apply(n,r):n(...r);let i=n.prototype;return o=i[l.__invoke]||i.__invoke,o&&!C&&(C=!0,console.warn("applyMagic: using __invoke without 'static' modifier is deprecated")),d(n,o,"__invoke"),o?o(...r):n(...r)}else return Object.assign(this,new n(...r)),g(this)};return Object.setPrototypeOf(t,n),Object.setPrototypeOf(t.prototype,n.prototype),b(t,"name",n.name),b(t,"length",n.length),b(t,"toString",function(){let r=this===t?n:this;return Function.prototype.toString.call(r)},!0),t}else{if(typeof n=="object")return g(n);throw new TypeError("'target' must be a function or an object")}}l.applyMagic=A;function d(n,e,t,s=void 0){if(e!==void 0){if(typeof e!="function")throw new TypeError(`${n.name}.${t} must be a function`);if(s!==void 0&&e.length!==s)throw new SyntaxError(`${n.name}.${t} must have ${s} parameter${s===1?"":"s"}`)}}function b(n,e,t,s=!1){Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:s,value:t})}function g(n){let e=n[l.__get]||n.__get,t=n[l.__set]||n.__set,s=n[l.__has]||n.__has,r=n[l.__delete]||n.__delete;return d(new.target,e,"__get",1),d(new.target,t,"__set",2),d(new.target,s,"__has",1),d(new.target,r,"__delete",1),new Proxy(n,{get:(o,i)=>e?e.call(o,i):o[i],set:(o,i,u)=>(t?t.call(o,i,u):o[i]=u,!0),has:(o,i)=>s?s.call(o,i):i in o,deleteProperty:(o,i)=>(r?r.call(o,i):delete o[i],!0)})}});var v=E(R());var w=E(R());var _=class{logger;httpRequestErrorService;constructor(e,t){this.logger=e,this.httpRequestErrorService=t}process(e){var s;(s=this.logger)!=null&&s.warn&&this.logger.warn("API ERROR",e);let t=e;typeof e=="string"&&(t=new Error(e)),this.httpRequestErrorService&&(typeof this.httpRequestErrorService.process<"u"?this.httpRequestErrorService.process(t):typeof this.httpRequestErrorService=="function"&&this.httpRequestErrorService(t))}};var h=class{requestInstance;timeout=3e4;cancellable=!1;strategy="reject";flattenResponse=!0;defaultResponse=null;axios;logger;httpRequestErrorService;requestsQueue;constructor({axios:e,baseURL:t="",timeout:s=null,cancellable:r=!1,strategy:o=null,flattenResponse:i=null,defaultResponse:u={},logger:a=null,onError:c=null,...p}){this.axios=e,this.timeout=s!==null?s:this.timeout,this.strategy=o!==null?o:this.strategy,this.cancellable=r||this.cancellable,this.flattenResponse=i!==null?i:this.flattenResponse,this.defaultResponse=u,this.logger=a||global.console||window.console||null,this.httpRequestErrorService=c,this.requestsQueue=new Map,this.requestInstance=e.create({...p,baseURL:t,timeout:this.timeout})}getInstance(){return this.requestInstance}__get(e){return e in this?this[e]:this.prepareRequest.bind(this,e)}prepareRequest(e,t,s=null,r=null){return this.handleRequest({type:e,url:t,data:s,config:r})}buildRequestConfig(e,t,s,r){let o=e.toLowerCase();return{...r,url:t,method:o,[o==="get"||o==="head"?"params":"data"]:s||{}}}processRequestError(e,t){if(this.isRequestCancelled(e,t))return;t.onError&&typeof t.onError=="function"&&t.onError(e),new _(this.logger,this.httpRequestErrorService).process(e)}async outputErrorResponse(e,t){let s=this.isRequestCancelled(e,t),r=t.strategy||this.strategy;return s&&!t.rejectCancelled?this.defaultResponse:r==="silent"?(await new Promise(()=>null),this.defaultResponse):r==="reject"||r==="throwError"?Promise.reject(e):this.defaultResponse}isRequestCancelled(e,t){return this.axios.isCancel(e)}addCancellationToken(e){if(!this.cancellable&&!e.cancellable)return{};if(typeof e.cancellable<"u"&&!e.cancellable)return{};if(typeof AbortController>"u")return console.error("AbortController is unavailable in your ENV."),{};let{method:t,baseURL:s,url:r,params:o,data:i}=e,u=JSON.stringify([t,s,r,o,i]).substring(0,55**5),a=this.requestsQueue.get(u);a&&a.abort();let c=new AbortController;return this.requestsQueue.set(u,c),{signal:c.signal}}async handleRequest({type:e,url:t,data:s=null,config:r=null}){let o=null,i=r||{},u=this.buildRequestConfig(e,t,s,i);u={...this.addCancellationToken(u),...u};try{o=await this.requestInstance.request(u)}catch(a){return this.processRequestError(a,u),this.outputErrorResponse(a,u)}return this.processResponseData(o)}processResponseData(e){return e.data?this.flattenResponse?typeof e.data=="object"&&typeof e.data.data<"u"&&Object.keys(e.data).length===1?e.data.data:e.data:e:this.defaultResponse}};h=y([w.applyMagic],h);var f=class{requestHandler;endpoints;logger;constructor({axios:e,apiUrl:t,endpoints:s,timeout:r=null,cancellable:o=!1,strategy:i=null,flattenResponse:u=null,defaultResponse:a={},logger:c=null,onError:p=null,...I}){this.endpoints=s,this.logger=c,this.requestHandler=new h({...I,baseURL:t,axios:e,timeout:r,cancellable:o,strategy:i,flattenResponse:u,defaultResponse:a,logger:c,onError:p})}getInstance(){return this.requestHandler.getInstance()}__get(e){return e in this?this[e]:this.endpoints[e]?this.handleRequest.bind(this,e):this.handleNonImplemented.bind(this,e)}async handleRequest(...e){let t=e[0],s=this.endpoints[t],r=e[1]||{},o=e[2]||{},i=e[3]||{},u=s.url.replace(/:[a-z]+/gi,p=>o[p.substring(1)]?o[p.substring(1)]:p),a=null,c={...s};return delete c.url,delete c.method,a=await this.requestHandler[(s.method||"get").toLowerCase()](u,r,{...i,...c}),a}handleNonImplemented(e){var t;return(t=this.logger)!=null&&t.log&&this.logger.log(`${e} endpoint not implemented.`),Promise.resolve(null)}};f=y([v.applyMagic],f);var J=n=>new f(n);})();
//# sourceMappingURL=index.global.js.map